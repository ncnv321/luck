<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="/index.css" rel="stylesheet" type="text/css" media="all" />
    <link href="/gallery.css" rel="stylesheet" type="text/css" media="all" />
    <title>Art Gallery | luck</title>
    <link rel="icon" type="image/x-icon" href=" " />
    <!-- Sanity client library -->
    <script src="https://cdn.jsdelivr.net/npm/@sanity/client@5.4.2/dist/index.browser.min.js"></script>

    <!-- SimpleLightbox for image gallery -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.12.1/simple-lightbox.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplelightbox/2.12.1/simple-lightbox.min.js"></script>
    <style>
      /* Critical styles for immediate application */
      .mainframe {
        overflow-y: scroll !important;
        height: 500px !important;
        /* Wider mainframe for gallery */
        width: 680px !important;
      }

      .sideframe {
        overflow-y: auto !important;
        overflow-x: hidden !important;
        height: 500px !important;
      }

      /* Special styling for right sideframe in art gallery only */
      .art-gallery-right-sideframe {
        width: 5px !important; /* Ultra thin right sidebar */
        border-left: none !important; /* Remove left border to avoid double border */
        background-color: black !important; /* Match background */
        opacity: 0 !important; /* Make invisible */
        pointer-events: none !important; /* Prevent interaction */
      }

      /* Ensure left sideframe is proper width */
      .left-sideframe {
        width: 175px !important;
      }

      /* IMPORTANT: Force dotted borders on sections */
      .left-section:not(.left-bottom-section) {
        border-bottom: 1px dashed white !important;
      }

      /* Force proper text spacing */
      p {
        margin-top: 0.5em !important;
        margin-bottom: 0.5em !important;
      }

      /* Year sections with forced dotted underlines */
      .year-section h2 {
        text-align: center !important;
        border-bottom: 1px dashed white !important;
        padding-bottom: 5px !important;
        margin: 20px 0 15px 0 !important;
      }

      /* Gallery title */
      .gallery-title {
        text-align: center !important;
        margin-bottom: 20px !important;
        font-size: 1.5em !important;
      }

      /* Filter box styles */
      .filters {
        margin: 10px 0 !important;
        padding: 10px !important;
        border: 1px dashed #666 !important;
        text-align: center !important;
        min-height: 100px !important;
      }

      /* Thumbnail grid layout */
      .thumbnail-grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)) !important;
        gap: 15px !important;
        margin-bottom: 25px !important;
      }

      /* Force thumbnail images to display properly */
      .thumbnail img {
        max-width: 200px !important;
        max-height: 200px !important;
        width: 100% !important;
        height: auto !important;
        aspect-ratio: 1 / 1 !important;
        object-fit: cover !important;
      }

      /* Hide the Swup progress bar */
      .swup-progress-bar {
        display: none !important;
      }
    </style>
  </head>

  <body>
    <div class="header02">
      <a href="/"> <img src="" /> </a>
    </div>

    <div class="banner"></div>

    <main id="swup" class="transition-fade">
      <div class="mainwrapper">
        <!-- Keep the original flex layout structure to match other pages -->
        <div style="display: flex">
          <!-- Left sideframe -->
          <div class="sideframe left-sideframe">
            <div
              class="left-section left-top-section filter-section"
              style="border-bottom: 1px dashed white !important"
            >
              <center><h3 id="h3navmargins">Filters</h3></center>
              <div class="sidecontent">
                <section
                  class="filters"
                  style="
                    margin: 10px 0 !important;
                    padding: 10px !important;
                    border: 1px dashed #666 !important;
                    text-align: center !important;
                    min-height: 100px !important;
                  "
                >
                  <p
                    style="
                      margin-top: 0.5em !important;
                      margin-bottom: 0.5em !important;
                    "
                  >
                    (Filters coming soon)
                  </p>
                </section>
              </div>
            </div>

            <div class="left-section left-bottom-section">
              <center></center>
              <div class="sidecontent">
                <center>
                  <div style="margin: 0px 0">
                    <a
                      href="/"
                      style="display: inline-block"
                      class="about-link"
                      title="Wah!"
                    >
                      <img
                        src="/bnuuy_closed.png"
                        alt="Home"
                        class="icon-default"
                        style="
                          width: 75px;
                          height: 103px;
                          vertical-align: middle;
                        "
                      />
                      <img
                        src="/bnuuy_open.png"
                        alt="Home Hover"
                        class="icon-hover"
                        style="
                          width: 75px;
                          height: 103px;
                          display: none;
                          vertical-align: middle;
                        "
                      />
                    </a>
                  </div>
                  <div
                    class="quick-links"
                    style="text-align: left; margin-top: 15px"
                  >
                    <p
                      style="
                        margin-top: 0.5em !important;
                        margin-bottom: 0.5em !important;
                      "
                    >
                      <img
                        src="/aboutmeee.png"
                        style="height: 15px"
                        alt="icon"
                      />
                      <a href="/aboutme.html">About me</a><br />
                      <img
                        src="/paperr.png"
                        style="height: 15px; vertical-align: middle"
                        alt="icon"
                      />
                      <a href="/journal.html">Journal</a><br />
                      <img
                        src="/musicc.png"
                        style="height: 15px; vertical-align: middle"
                        alt="icon"
                      />
                      <a href="/music.html">Music</a> <br />
                      <img
                        src="/chatt.png"
                        style="height: 15px; vertical-align: middle"
                        alt="icon"
                      />
                      <a
                        href="http://users.smartgb.com/g/g.php?a=s&i=g19-00984-40"
                        target="_blank"
                        >Guestbook</a
                      >
                    </p>
                  </div>
                </center>
              </div>
            </div>
          </div>

          <!-- Mainframe with wider width -->
          <div class="mainframe" style="width: 680px !important">
            <div class="maincontent gallery-content">
              <h2
                class="gallery-title"
                style="
                  text-align: center !important;
                  margin-bottom: 20px !important;
                  font-size: 1.5em !important;
                "
              >
                luck's art archive
              </h2>

              <section class="artworks">
                <!-- Dynamic content will be loaded here by sanity-gallery.js -->
                <div
                  class="loading-indicator"
                  style="text-align: center; padding: 20px"
                >
                  Loading gallery...
                </div>
              </section>
            </div>
          </div>

          <!-- Camouflaged right sideframe (empty but preserves layout structure) -->
          <div class="sideframe art-gallery-right-sideframe">
            <!-- Intentionally empty -->
          </div>
        </div>
      </div>
    </main>
    <footer>
      <p id="paragraphstyling"><small> luck est. 2023 </small></p>
    </footer>

    <script src="https://unpkg.com/swup@4"></script>
    <script src="https://unpkg.com/@swup/progress-plugin@3"></script>
    <script>
      // Wait for DOM content to be loaded before initializing Swup
      document.addEventListener("DOMContentLoaded", function () {
        // Force CSS reloading function
        function forceStyleReload() {
          // Create a duplicate of each stylesheet and replace the original
          // This forces the browser to re-evaluate all CSS rules
          const stylesheets = document.querySelectorAll(
            'link[rel="stylesheet"]'
          );
          stylesheets.forEach((sheet) => {
            // Skip if already processed
            if (sheet.dataset.processed) return;

            // Clone the stylesheet
            const newLink = document.createElement("link");
            newLink.rel = "stylesheet";
            newLink.href = sheet.href;
            newLink.dataset.processed = "true";

            // Insert the new one and remove the old one
            sheet.parentNode.insertBefore(newLink, sheet);

            // Slight delay before removing the old one
            setTimeout(() => {
              sheet.parentNode.removeChild(sheet);
            }, 50);
          });
        }

        // Apply art gallery specific styles with inline style forcing
        function applyArtGalleryStyles() {
          // Check if we're on the art gallery page
          if (window.location.pathname.includes("/art.html")) {
            console.log("Art Gallery page detected - applying layout fixes");

            // Force all dotted borders with inline styles
            const leftSections = document.querySelectorAll(
              ".left-section:not(.left-bottom-section)"
            );
            leftSections.forEach((section) => {
              section.style.borderBottom = "1px dashed white";
            });

            // Force filter box styling
            const filtersBox = document.querySelector(".filters");
            if (filtersBox) {
              filtersBox.style.margin = "10px 0";
              filtersBox.style.padding = "10px";
              filtersBox.style.border = "1px dashed #666";
              filtersBox.style.textAlign = "center";
              filtersBox.style.minHeight = "100px";
            }

            // Force all year section headings
            const yearHeadings = document.querySelectorAll(".year-section h2");
            yearHeadings.forEach((heading) => {
              heading.style.textAlign = "center";
              heading.style.borderBottom = "1px dashed white";
              heading.style.paddingBottom = "5px";
              heading.style.margin = "20px 0 15px 0";
            });

            // Force all paragraph margins
            const paragraphs = document.querySelectorAll("p");
            paragraphs.forEach((p) => {
              p.style.marginTop = "0.5em";
              p.style.marginBottom = "0.5em";
            });

            // Find the right sideframe and make it invisible
            const sideframes = document.querySelectorAll(".sideframe");
            if (sideframes.length > 1) {
              const rightSideframe = sideframes[sideframes.length - 1];
              if (!rightSideframe.classList.contains("left-sideframe")) {
                rightSideframe.classList.add("art-gallery-right-sideframe");
                rightSideframe.style.width = "5px";
                rightSideframe.style.borderLeft = "none";
                rightSideframe.style.backgroundColor = "black";
                rightSideframe.style.opacity = "0";
                rightSideframe.style.pointerEvents = "none";
              }
            }

            // Ensure mainframe is the right size
            const mainframe = document.querySelector(".mainframe");
            if (mainframe) {
              mainframe.style.width = "680px";
              mainframe.style.overflowY = "scroll";
            }

            // Force reload CSS to ensure all styles are applied
            forceStyleReload();
          }
        }

        // Apply styles immediately
        applyArtGalleryStyles();

        // Make swup a global variable so bannerbar.js can access it
        window.swup = new Swup({
          plugins: [
            new SwupProgressPlugin({
              showProgressBar: false, // Disable default progress bar
            }),
          ],
          cache: false, // Disable content caching for consistent behavior
          animateHistoryBrowsing: true, // Force animation on history navigation
          animationSelector: '[class*="transition-"]', // Select elements with transition class
          containers: ["#swup"], // The container that will be replaced
        });

        // Add event listeners for Swup events
        window.swup.hooks.on("content:replace", function () {
          // Wait a bit for DOM to update
          setTimeout(applyArtGalleryStyles, 100);
        });

        window.swup.hooks.on("page:view", function () {
          // Apply styles after view is complete
          setTimeout(applyArtGalleryStyles, 100);
        });

        // Also set up a MutationObserver to detect DOM changes
        const observer = new MutationObserver(function (mutations) {
          if (window.location.pathname.includes("/art.html")) {
            applyArtGalleryStyles();
          }
        });

        // Start observing
        observer.observe(document.body, {
          childList: true,
          subtree: true,
        });

        console.log("Swup initialized with enhanced art gallery layout fixes");
      });
    </script>
    <script src="/bannerbar.js"></script>
    <!-- Gallery Script -->
    <script src="/sanity-gallery.js"></script>
  </body>
</html>
